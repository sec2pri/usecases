#Package manager:
if(!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager",repos = "http://cran.us.r-project.org")
#Package for path variable
if(!"rstudioapi" %in% installed.packages()) BiocManager::install("rstudioapi")
#Libraries required for markdown documents:
if(!"markdown" %in% installed.packages()){install.packages("markdown")}
if(!"rmarkdown" %in% installed.packages()){install.packages("rmarkdown")}
#load libraries
library(rstudioapi)
# set working environment to current folder
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
#Package manager:
if(!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager",repos = "http://cran.us.r-project.org")
#Package for path variable
if(!"rstudioapi" %in% installed.packages()) BiocManager::install("rstudioapi")
#Libraries required for markdown documents:
if(!"markdown" %in% installed.packages()){install.packages("markdown")}
if(!"rmarkdown" %in% installed.packages()){install.packages("rmarkdown")}
if(!"dplyr" %in% installed.packages()){install.packages("dplyr")}
#load libraries
library(rstudioapi)
library(dplyr)
# set working environment to current folder
workingDirectory <- setwd(dirname(rstudioapi::getSourceEditorContext()$path))
##Only download the data, if not available already locally.
##UniProt mappings
if(!file.exists("dataInput/UniProt2Reactome.txt")){
download.file('https://reactome.org/download/current/UniProt2Reactome_PE_Pathway.txt', destfile=paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), method = "wget", extra = "-r -p --random-wait")
}
##Ensembl mappings
if(!file.exists("dataInput/Ensembl2Reactome.txt")) {
download.file('https://reactome.org/download/current/Ensembl2Reactome_PE_Pathway.txt', destfile=paste0(workingDirectory, '/dataInput/Ensembl2Reactome.txt'), method = "wget", extra = "-r -p --random-wait")
}
##NCBI mappings
if(!file.exists("dataInput/NCBI2Reactome.txt")) {
download.file('https://reactome.org/download/current/NCBI2Reactome_PE_Pathway.txt', destfile=paste0(workingDirectory, '/dataInput/NCBI2Reactome.txt'), method = "wget", extra = "-r -p --random-wait")
}
##Store the data in a dataframe, extract the relevant information, and merge results:
UniprotReactome <- read.delim(paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Dataframe
UniprotReactome <- UniprotReactome[UniprotReactome[8] == 'Homo sapiens',]
UniprotReactome <- UniprotReactome[c(3)]
UniprotReactome <- unique(UniprotReactome)
UniprotReactome <- separate(UniprotReactome, UniprotReactome[1], into = c("HGNC", "Location"), sep = " (?=[^ ]+$)")
library(tidyr)
UniprotReactome <- separate(UniprotReactome, UniprotReactome[1], into = c("HGNC", "Location"), sep = " (?=[^ ]+$)")
UniprotReactome[1,1]
View(UniprotReactome)
View(UniprotReactome)
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=[^ ]+$)")
UniprotReactome <- read.delim(paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Dataframe
UniprotReactome <- UniprotReactome[UniprotReactome[8] == 'Homo sapiens',]
UniprotReactome <- UniprotReactome[c(3)]
UniprotReactome <- unique(UniprotReactome)
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=[^ \[]+$)")
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=[^ \\[]+$)")
View(UniprotReactome)
UniprotReactome <- read.delim(paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Dataframe
UniprotReactome <- UniprotReactome[UniprotReactome[8] == 'Homo sapiens',]
UniprotReactome <- UniprotReactome[c(3)]
UniprotReactome <- unique(UniprotReactome)
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=[^ []+$)")
View(UniprotReactome)
##Store the data in a dataframe, extract the relevant information, and merge results:
UniprotReactome <- read.delim(paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Dataframe
UniprotReactome <- UniprotReactome[UniprotReactome[8] == 'Homo sapiens',]
UniprotReactome <- UniprotReactome[c(3)]
UniprotReactome <- unique(UniprotReactome)
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=[^ \[]+$)")
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=[^ \\[]+$)")
##Store the data in a dataframe, extract the relevant information, and merge results:
UniprotReactome <- read.delim(paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Dataframe
UniprotReactome <- UniprotReactome[UniprotReactome[8] == 'Homo sapiens',]
UniprotReactome <- UniprotReactome[c(3)]
UniprotReactome <- unique(UniprotReactome)
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (\[[^\]]*\])")
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (\\[[^\\]]*\\])")
##Store the data in a dataframe, extract the relevant information, and merge results:
UniprotReactome <- read.delim(paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Dataframe
UniprotReactome <- UniprotReactome[UniprotReactome[8] == 'Homo sapiens',]
UniprotReactome <- UniprotReactome[c(3)]
UniprotReactome <- unique(UniprotReactome)
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = "?=(\\[[^\\]]*\\])")
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=(\\[[^\\]]*\\])+$)")
##Store the data in a dataframe, extract the relevant information, and merge results:
UniprotReactome <- read.delim(paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Create dataframe from input data
UniprotReactome <- UniprotReactome[UniprotReactome[8] == 'Homo sapiens',] #Only keep data for one species (Homo sapiens)
UniprotReactome <- UniprotReactome[c(3)] #Retain column with HGNC Symbols
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=(\\[[^\\]]*\\])+$)") ##Split localization data from HGNC symbol
UniprotReactome <- unique(UniprotReactome) #Keep unique symbols only (still includes localization data)
UniprotReactome <- UniprotReactome[c(1)] #remove localization data
UniprotReactome <- unique(UniprotReactome) #Keep unique symbols only
EnsemblReactome <- read.delim(paste0(workingDirectory, '/dataInput/Ensembl2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Create dataframe from input data
View(EnsemblReactome)
EnsemblReactome <- EnsemblReactome[EnsemblReactome[8] == 'Homo sapiens',] #Only keep data for one species (Homo sapiens)
EnsemblReactome <- EnsemblReactome[c(3)] #Retain column with HGNC Symbols
EnsemblReactome <- separate(EnsemblReactome, V3, into = c("HGNC", "Location"), sep = " (?=(\\[[^\\]]*\\])+$)") ##Split localization data from HGNC symbol
View(EnsemblReactome)
EnsemblReactome <- EnsemblReactome[c(1)] #remove localization data
EnsemblReactome <- unique(EnsemblReactome) #Keep unique symbols only
#NCBI mappings
NCBIReactome <- read.delim(paste0(workingDirectory, '/dataInput/NCBI2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Create dataframe from input data
NCBIReactome <- NCBIReactome[NCBIReactome[8] == 'Homo sapiens',] #Only keep data for one species (Homo sapiens)
NCBIReactome <- NCBIReactome[c(3)] #Retain column with HGNC Symbols
NCBIReactome <- separate(NCBIReactome, V3, into = c("HGNC", "Location"), sep = " (?=(\\[[^\\]]*\\])+$)") ##Split localization data from HGNC symbol
NCBIReactome <- NCBIReactome[c(1)] #remove localization data
NCBIReactome <- unique(NCBIReactome) #Keep unique symbols only
View(NCBIReactome)
#Merge the data together
df_list <- list(UniprotReactome, EnsemblReactome, NCBIReactome)
Reduce(function(x, y) merge(x, y, all=TRUE), df_list, accumulate=FALSE)
View(df_list)
#Merge the data together
df_list <- list(UniprotReactome, EnsemblReactome, NCBIReactome)
mergedReactome <- Reduce(function(x, y) merge(x, y, all=TRUE), df_list, accumulate=FALSE)
View(mergedReactome)
mergedReactome <- unique(mergedReactome) #Keep unique symbols only
#Remove unnecessary data
rm(list=setdiff(ls(), "mergedReactome"))
#Package manager:
if(!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager",repos = "http://cran.us.r-project.org")
#Package for path variable
if(!"rstudioapi" %in% installed.packages()) BiocManager::install("rstudioapi")
#Libraries required for markdown documents:
if(!"markdown" %in% installed.packages()){install.packages("markdown")}
if(!"rmarkdown" %in% installed.packages()){install.packages("rmarkdown")}
if(!"dplyr" %in% installed.packages()){install.packages("dplyr")}
#load libraries
library(rstudioapi)
library(dplyr)
library(tidyr)
# set working environment to current folder
workingDirectory <- setwd(dirname(rstudioapi::getSourceEditorContext()$path))
##Only download the data, if not available already locally.
##UniProt mappings
if(!file.exists("dataInput/UniProt2Reactome.txt")){
download.file('https://reactome.org/download/current/UniProt2Reactome_PE_Pathway.txt', destfile=paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), method = "wget", extra = "-r -p --random-wait")
}
##Ensembl mappings
if(!file.exists("dataInput/Ensembl2Reactome.txt")) {
download.file('https://reactome.org/download/current/Ensembl2Reactome_PE_Pathway.txt', destfile=paste0(workingDirectory, '/dataInput/Ensembl2Reactome.txt'), method = "wget", extra = "-r -p --random-wait")
}
##NCBI mappings
if(!file.exists("dataInput/NCBI2Reactome.txt")) {
download.file('https://reactome.org/download/current/NCBI2Reactome_PE_Pathway.txt', destfile=paste0(workingDirectory, '/dataInput/NCBI2Reactome.txt'), method = "wget", extra = "-r -p --random-wait")
}
##Store the data in a dataframe, extract the relevant information, and merge results from three mapping systems (if needed):
#Uniprot mappings
UniprotReactome <- read.delim(paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Create dataframe from input data
UniprotReactome <- UniprotReactome[UniprotReactome[8] == 'Homo sapiens',] #Only keep data for one species (Homo sapiens)
UniprotReactome <- UniprotReactome[c(3)] #Retain column with HGNC Symbols
UniprotReactome <- separate(UniprotReactome, V3, into = c("HGNC", "Location"), sep = " (?=(\\[[^\\]]*\\])+$)") ##Split localization data from HGNC symbol
UniprotReactome <- UniprotReactome[c(1)] #remove localization data
UniprotReactome <- unique(UniprotReactome) #Keep unique symbols only
#Ensembl mappings
EnsemblReactome <- read.delim(paste0(workingDirectory, '/dataInput/Ensembl2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Create dataframe from input data
EnsemblReactome <- EnsemblReactome[EnsemblReactome[8] == 'Homo sapiens',] #Only keep data for one species (Homo sapiens)
EnsemblReactome <- EnsemblReactome[c(3)] #Retain column with HGNC Symbols
EnsemblReactome <- separate(EnsemblReactome, V3, into = c("HGNC", "Location"), sep = " (?=(\\[[^\\]]*\\])+$)") ##Split localization data from HGNC symbol
EnsemblReactome <- EnsemblReactome[c(1)] #remove localization data
EnsemblReactome <- unique(EnsemblReactome) #Keep unique symbols only
#NCBI mappings
NCBIReactome <- read.delim(paste0(workingDirectory, '/dataInput/NCBI2Reactome.txt'), header = FALSE, sep = "\t", dec = ".") #Create dataframe from input data
NCBIReactome <- NCBIReactome[NCBIReactome[8] == 'Homo sapiens',] #Only keep data for one species (Homo sapiens)
NCBIReactome <- NCBIReactome[c(3)] #Retain column with HGNC Symbols
NCBIReactome <- separate(NCBIReactome, V3, into = c("HGNC", "Location"), sep = " (?=(\\[[^\\]]*\\])+$)") ##Split localization data from HGNC symbol
NCBIReactome <- NCBIReactome[c(1)] #remove localization data
NCBIReactome <- unique(NCBIReactome) #Keep unique symbols only
#Merge the data together
df_list <- list(UniprotReactome, EnsemblReactome, NCBIReactome)
mergedReactome <- Reduce(function(x, y) merge(x, y, all=TRUE), df_list, accumulate=FALSE)
#mergedReactome <- unique(mergedReactome) #Keep unique symbols only (to check if above function worked correctly)
#Remove unnecessary data
rm(list=setdiff(ls(), c["mergedReactome", workingDirectory]))
rm(list=setdiff(ls(), c["mergedReactome", "workingDirectory"]))
#Remove unnecessary data
retain <- c("mergedReactome", "workingDirectory")
rm(list=setdiff(ls(), retain))
HGNCMappings <- EnsemblReactome <- read.delim(paste0(workingDirectory, '/dataInput/HGNC_secID2priID.tsv'), header = TRUE, sep = "\t", dec = ".") #Create dataframe from HGNC Symbols data
View(EnsemblReactome)
#Remove unnecessary data
retain <- c("mergedReactome", "workingDirectory", "HGNCMappings")
rm(list=setdiff(ls(), retain))
View(HGNCMappings)
##Create unique set of primary IDs (without overlap to secondaries)
primaryHGNCSymbols <- setdiff(HGNCMappings$primarySymbol, HGNCMappings$secondarySymbol)
##Create unique set of secondary IDs (without overlap to primaries)
secondaryHGNCSymbols <- setdiff(HGNCMappings$secondarySymbol, HGNCMappings$primarySymbol)
##Install and load required packages:
api_packages <- c("httr", "jsonlite", "data.table")
for (i in 1:length(api_packages)) {
if(!api_packages[i] %in% installed.packages()){install.packages(api_packages[i])}
}
#install.packages(c("httr", "jsonlite", "data.table"))
library(httr)
library(jsonlite)
library(data.table)
## pathway map IDs listed under "1.3 Lipid metabolism"
lipid_kegg_maps <- c("00061", "00062", "00071", "00073", "00100", "00120", "00121", "00140", "00561", "00564", "00565", "00600", "00590", "00591", "00592", "01040")
##Add URL for query item:
lipid_kegg_genes_APIcall <- paste("https://rest.kegg.jp/link/hsa/hsa", lipid_kegg_maps, sep="")
##Create an empty dataframe to store the results of the loop:
Kegg_genes_total = data.frame()
## Execute API calls, example to obtain chemical compounds for a PW map:
for (i in 1:length(lipid_kegg_metabolites_APIcall)) {
##Get the genes:
res_genes = GET(lipid_kegg_genes_APIcall[i])
Kegg_data_genes <- rawToChar(res_genes$content)
if(length(res_genes$content)>1){
cleaned_Kegg_data_genes <- fread(text = Kegg_data_genes, header=FALSE, fill = TRUE)
df_genes <- data.frame(cleaned_Kegg_data_genes)
Kegg_genes_total <- rbind(Kegg_genes_total,df_genes)
}
}
## Execute API calls, example to obtain chemical compounds for a PW map:
for (i in 1:length(lipid_kegg_genes_APIcall)) {
##Get the genes:
res_genes = GET(lipid_kegg_genes_APIcall[i])
Kegg_data_genes <- rawToChar(res_genes$content)
if(length(res_genes$content)>1){
cleaned_Kegg_data_genes <- fread(text = Kegg_data_genes, header=FALSE, fill = TRUE)
df_genes <- data.frame(cleaned_Kegg_data_genes)
Kegg_genes_total <- rbind(Kegg_genes_total,df_genes)
}
}
##Keep only dataframes with name "_total" to safe space
#rm(list = ls()[!grepl("_total", ls())])
# Since we are pre-selecting Lipid pathways, we can just take the count of unique entries:
unique_lipids_genes_kegg <- nrow(unique(Kegg_genes_total[2]))
View(Kegg_genes_total)
kegg_maps_APIcall <- "https://rest.kegg.jp/list/pathway/hsa"
res_maps = GET(kegg_maps_APIcall)
Kegg_data_maps <- rawToChar(res_maps$content)
kegg_maps_APIcall <- "https://rest.kegg.jp/list/pathway/hsa"
res_maps = GET(kegg_maps_APIcall)
Kegg_data_maps <- rawToChar(res_maps$content)
if(length(res_genes$content)>1){
cleaned_Kegg_data_maps <- fread(text = Kegg_data_maps, header=FALSE, fill = TRUE)
df_maps <- data.frame(cleaned_Kegg_data_maps)
Kegg_maps_total <- rbind(Kegg_maps_total,df_maps)
}
Kegg_maps_total = data.frame()
if(length(res_genes$content)>1){
cleaned_Kegg_data_maps <- fread(text = Kegg_data_maps, header=FALSE, fill = TRUE)
df_maps <- data.frame(cleaned_Kegg_data_maps)
Kegg_maps_total <- rbind(Kegg_maps_total,df_maps)
}
View(Kegg_maps_total)
kegg_maps_APIcall <- "https://rest.kegg.jp/list/pathway/hsa"
res_maps = GET(kegg_maps_APIcall)
Kegg_data_maps <- rawToChar(res_maps$content)
Kegg_maps_total = data.frame()
if(length(res_genes$content)>1){
cleaned_Kegg_data_maps <- fread(text = Kegg_data_maps, header=FALSE, fill = TRUE, sep = '\t')
df_maps <- data.frame(cleaned_Kegg_data_maps)
Kegg_maps_total <- rbind(Kegg_maps_total,df_maps)
}
Kegg_maps_total[1]
c(Kegg_maps_total[1])
lipid_kegg_maps
##Add URL for query item:
kegg_genes_APIcall <- paste("https://rest.kegg.jp/link/hsa/hsa", c(Kegg_maps_total[1]), sep="")
length(c(Kegg_maps_total[1]))
length(Kegg_maps_total[1])
nrow(Kegg_maps_total[1])
##Add URL for query item:
kegg_genes_APIcall <- paste("https://rest.kegg.jp/link/hsa/hsa", c(Kegg_maps_total[1]), sep="")
##Create an empty dataframe to store the results of the loop:
Kegg_genes_total = data.frame()
## Execute API calls, example to obtain chemical compounds for a PW map:
for (i in 1:length(nrow(Kegg_maps_total[1]))) {
##Get the genes:
res_genes = GET(kegg_genes_APIcall[i])
Kegg_data_genes <- rawToChar(res_genes$content)
if(length(res_genes$content)>1){
cleaned_Kegg_data_genes <- fread(text = Kegg_data_genes, header=FALSE, fill = TRUE)
df_genes <- data.frame(cleaned_Kegg_data_genes)
Kegg_genes_total <- rbind(Kegg_genes_total,df_genes)
}
}
kegg_genes_APIcall
lipid_kegg_maps <- c("00061", "00062", "00071", "00073", "00100", "00120", "00121", "00140", "00561", "00564", "00565", "00600", "00590", "00591", "00592", "01040")
c(Kegg_maps_total[1])
kegg_maps <- c(Kegg_maps_total[1])
##Add URL for query item:
kegg_genes_APIcall <- paste("https://rest.kegg.jp/link/hsa/", kegg_maps, sep="")
kegg maps
kegg_maps
kegg_maps <- as.vector(c(Kegg_maps_total[1]))
kegg_maps
kegg_maps <- as.vector(Kegg_maps_total[1])
kegg_maps
kegg_maps <- as.character(Kegg_maps_total[1])
kegg_maps
kegg_maps <- as.character(c(Kegg_maps_total[1]))
kegg_maps
Kegg_maps_total[1]
kegg_maps <- as.array(c(Kegg_maps_total[1]))
kegg_maps
kegg_maps <- as.array(Kegg_maps_total[1])
kegg_maps <- Kegg_maps_total$V1
kegg_maps
##Add URL for query item:
kegg_genes_APIcall <- paste("https://rest.kegg.jp/link/hsa/", kegg_maps, sep="")
kegg_genes_APIcall
##Create an empty dataframe to store the results of the loop:
Kegg_genes_total = data.frame()
## Execute API calls, example to obtain chemical compounds for a PW map:
for (i in 1:length(nrow(Kegg_maps_total[1]))) {
##Get the genes:
res_genes = GET(kegg_genes_APIcall[i])
Kegg_data_genes <- rawToChar(res_genes$content)
if(length(res_genes$content)>1){
cleaned_Kegg_data_genes <- fread(text = Kegg_data_genes, header=FALSE, fill = TRUE)
df_genes <- data.frame(cleaned_Kegg_data_genes)
Kegg_genes_total <- rbind(Kegg_genes_total,df_genes)
}
}
## Execute API calls, example to obtain chemical compounds for a PW map:
for (i in 1:length(nrow(Kegg_maps_total[1]))) {
##Get the genes:
res_genes = GET(kegg_genes_APIcall[i])
Kegg_data_genes <- rawToChar(res_genes$content)
if(length(res_genes$content)>1){
cleaned_Kegg_data_genes <- fread(text = Kegg_data_genes, header=FALSE, fill = TRUE)
df_genes <- data.frame(cleaned_Kegg_data_genes)
Kegg_genes_total <- rbind(Kegg_genes_total,df_genes)
}
}
##Install and load required packages:
api_packages <- c("httr", "jsonlite", "data.table")
for (i in 1:length(api_packages)) {
if(!api_packages[i] %in% installed.packages()){install.packages(api_packages[i])}
}
#install.packages(c("httr", "jsonlite", "data.table"))
library(httr)
library(jsonlite)
library(data.table)
##Create an empty dataframe to store the results of the loop:
Kegg_genes_total = data.frame()
## Execute API calls, example to obtain chemical compounds for a PW map:
for (i in 1:length(nrow(Kegg_maps_total[1]))) {
##Get the genes:
res_genes = GET(kegg_genes_APIcall[i])
Kegg_data_genes <- rawToChar(res_genes$content)
if(length(res_genes$content)>1){
cleaned_Kegg_data_genes <- fread(text = Kegg_data_genes, header=FALSE, fill = TRUE)
df_genes <- data.frame(cleaned_Kegg_data_genes)
Kegg_genes_total <- rbind(Kegg_genes_total,df_genes)
}
}
Kegg_genes_total
# Since we are pre-selecting Lipid pathways, we can just take the count of unique entries:
unique_genes_kegg <- nrow(unique(Kegg_genes_total[2]))
unique_genes_kegg
View(Kegg_genes_total)
View(cleaned_Kegg_data_genes)
retain = c("primaryHGNCSymbols", "secondaryHGNCSymbols")
rm(list=setdiff(ls(), retain))
#Package manager:
if(!requireNamespace("BiocManager", quietly = TRUE)) install.packages("BiocManager",repos = "http://cran.us.r-project.org")
#Package for path variable
if(!"rstudioapi" %in% installed.packages()) BiocManager::install("rstudioapi")
#Libraries required for markdown documents:
if(!"markdown" %in% installed.packages()){install.packages("markdown")}
if(!"rmarkdown" %in% installed.packages()){install.packages("rmarkdown")}
if(!"dplyr" %in% installed.packages()){install.packages("dplyr")}
#load libraries
library(rstudioapi)
library(dplyr)
library(tidyr)
# set working environment to current folder
workingDirectory <- setwd(dirname(rstudioapi::getSourceEditorContext()$path))
if(!file.exists("HGNC_secID2priID.tsv")){
#download.file('https://reactome.org/download/current/UniProt2Reactome_PE_Pathway.txt', destfile=paste0(workingDirectory, '/dataInput/UniProt2Reactome.txt'), method = "wget", extra = "-r -p --random-wait") ##Replace with Zenodo download when available!
}
HGNCMappings <- EnsemblReactome <- read.delim(paste0(workingDirectory, '/dataInput/HGNC_secID2priID.tsv'), header = TRUE, sep = "\t", dec = ".") #Create dataframe from HGNC Symbols data
##Create unique set of primary IDs (without overlap to secondaries)
primaryHGNCSymbols <- setdiff(HGNCMappings$primarySymbol, HGNCMappings$secondarySymbol)
##Create unique set of secondary IDs (without overlap to primaries)
secondaryHGNCSymbols <- setdiff(HGNCMappings$secondarySymbol, HGNCMappings$primarySymbol)
##Install and load required packages:
api_packages <- c("httr", "jsonlite", "data.table")
for (i in 1:length(api_packages)) {
if(!api_packages[i] %in% installed.packages()){install.packages(api_packages[i])}
}
#install.packages(c("httr", "jsonlite", "data.table"))
library(httr)
library(jsonlite)
library(data.table)
## pathway map IDs listed under "1.3 Lipid metabolism"
#lipid_kegg_maps <- c("00061", "00062", "00071", "00073", "00100", "00120", "00121", "00140", "00561", "00564", "00565", "00600", "00590", "00591", "00592", "01040")
kegg_maps_APIcall <- "https://rest.kegg.jp/list/pathway/hsa"
res_maps = GET(kegg_maps_APIcall)
Kegg_data_maps <- rawToChar(res_maps$content)
Kegg_maps_total = data.frame()
if(length(res_genes$content)>1){
cleaned_Kegg_data_maps <- fread(text = Kegg_data_maps, header=FALSE, fill = TRUE, sep = '\t')
df_maps <- data.frame(cleaned_Kegg_data_maps)
Kegg_maps_total <- rbind(Kegg_maps_total,df_maps)
}
##Install and load required packages:
api_packages <- c("httr", "jsonlite", "data.table")
for (i in 1:length(api_packages)) {
if(!api_packages[i] %in% installed.packages()){install.packages(api_packages[i])}
}
#install.packages(c("httr", "jsonlite", "data.table"))
library(httr)
library(jsonlite)
library(data.table)
## pathway map IDs listed under "1.3 Lipid metabolism"
#lipid_kegg_maps <- c("00061", "00062", "00071", "00073", "00100", "00120", "00121", "00140", "00561", "00564", "00565", "00600", "00590", "00591", "00592", "01040")
kegg_maps_APIcall <- "https://rest.kegg.jp/list/pathway/hsa"
res_maps = GET(kegg_maps_APIcall)
Kegg_data_maps <- rawToChar(res_maps$content)
Kegg_maps_total = data.frame()
if(length(res_maps$content)>1){
cleaned_Kegg_data_maps <- fread(text = Kegg_data_maps, header=FALSE, fill = TRUE, sep = '\t')
df_maps <- data.frame(cleaned_Kegg_data_maps)
Kegg_maps_total <- rbind(Kegg_maps_total,df_maps)
}
kegg_maps <- Kegg_maps_total$V1
##Add URL for query item:
kegg_genes_APIcall <- paste("https://rest.kegg.jp/link/hsa/", kegg_maps, sep="")
##Create an empty dataframe to store the results of the loop:
Kegg_genes_total = data.frame()
## Execute API calls, example to obtain chemical compounds for a PW map:
for (i in 1:length(nrow(Kegg_maps_total[1]))) {
##Get the genes:
res_genes = GET(kegg_genes_APIcall[i])
Kegg_data_genes <- rawToChar(res_genes$content)
if(length(res_genes$content)>1){
cleaned_Kegg_data_genes <- fread(text = Kegg_data_genes, header=FALSE, fill = TRUE)
df_genes <- data.frame(cleaned_Kegg_data_genes)
Kegg_genes_total <- rbind(Kegg_genes_total,df_genes)
}
}
##Keep only dataframes with name "_total" to save space
#rm(list = ls()[!grepl("_total", ls())])
retain = c("primaryHGNCSymbols", "secondaryHGNCSymbols", "workingDirectory")
rm(list=setdiff(ls(), retain))
##Keep only dataframes with name "_total" to save space
#rm(list = ls()[!grepl("_total", ls())])
retain = c("primaryHGNCSymbols", "secondaryHGNCSymbols", "workingDirectory", "retain")
rm(list=setdiff(ls(), retain))
retain <- append("mergedReactome", "workingDirectory", "HGNCMappings")
#Remove unnecessary data
retain <- append(retain, "mergedReactome", "workingDirectory", "HGNCMappings")
#Remove unnecessary data
retain <- append(retain, "mergedReactome")
retain
rm(list=setdiff(ls(), retain))
##WikiPathways (original pathways)
###PRIOR code to install SPARQl package; Package not available in CRAN anymore, only works for older version of R
#if(!"SPARQL" %in% installed.packages()){
#  install.packages("SPARQL")
#}
##Solution: download from archived version
#Location to install archived packages:
packageFolder <-paste0(workingDirectory, '/packages/SPARQL.tar.gz')
downloadLinkSPARQL <-"https://cran.r-project.org/src/contrib/Archive/SPARQL/SPARQL_1.16.tar.gz"
##Download archived version instead:
if(!"downloader" %in% installed.packages()){
install.packages("downloader")
}
library("downloader")
##Only download file if needed
if (!file.exists(packageFolder)) {
download.file(downloadLinkSPARQL, packageFolder)
}
##Install the local version of the library
install.packages(packageFolder, repos = NULL, type="source")
library(SPARQL)
##Connect to Endpoint WikiPathways
endpointwp <- "https://sparql.wikipathways.org/sparql"
## 1. Query metadata:
queryMetadata <-
"SELECT DISTINCT ?dataset (str(?titleLit) as ?title) ?date ?license
WHERE {
?dataset a void:Dataset ;
dcterms:title ?titleLit ;
dcterms:license ?license ;
pav:createdOn ?date .
}"
#below code should be performed first to handle the ssl certificate error
options(RCurlOptions = list(cainfo = paste0( tempdir() , "/cacert.pem" ), ssl.verifypeer = FALSE))
resultsMetadata <- SPARQL(endpointwp,queryMetadata,curl_args=list(useragent=R.version.string))
showresultsMetadata <- resultsMetadata$results
remove(queryMetadata, resultsMetadata)
##Rewrite to collect labels and original IDs.
## 2. Query WikiPathways PWs, through HGNC symbols:
queryWikiPathways <-
"PREFIX cur:            <http://vocabularies.wikipathways.org/wp#Curation:> #to differentiate between Reactome and WP PWs.
select distinct (fn:substring(?hgncId,37) as ?HGNC) (GROUP_CONCAT(DISTINCT str(?wpid);separator=', ') AS ?pathways)  (COUNT(DISTINCT str(?wpid)) AS ?usage)
where {
?pathwayRes a wp:Pathway ;                   #Define what is a pathway
wp:organismName 'Homo sapiens' ; #Filter pathways on species Human
dcterms:identifier ?wpid ;       #Obtain identifier of pathway
wp:ontologyTag cur:AnalysisCollection .  #Reactome: Reactome_Approved . WP: Curation:AnalysisCollection
?protein wp:bdbHgncSymbol ?hgncId ;          #Find proteins based on HGNC symbol
dcterms:isPartOf ?pathwayRes .      #Connect protein to PW
}
ORDER BY DESC (?usage)
"
##Execute query:
resultsWikiPathways <- SPARQL(endpointwp,queryWikiPathways,curl_args=list(useragent=R.version.string))
showresultsWikiPathways <- resultsWikiPathways$results
remove(queryWikiPathways, resultsWikiPathways)
