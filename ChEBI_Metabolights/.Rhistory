##Metabolights API location:
BASE_URL <- "https://www.ebi.ac.uk:443/metabolights/ws/studies"
##Access study IDs
getStudies <- function() {
studies <-
httr::GET(BASE_URL) %>% httr::content('parsed')
studyTibble <- dplyr::tibble(unlist(studies))
names(studyTibble) <- 'study'
return(studyTibble)
}
##Download all IDs of available studies.
allstudyIds <- getStudies()
##Convert response to a vector
vStudyIds <- allstudyIds[[1]]
# Retrieve MAF file names per study ID
getMafFiles <- function(studyId) {
# Construct URL for the specific study ID
url <- paste0(BASE_URL, "/", studyId, "/files?include_raw_data=false")
# Send GET request to retrieve data
response <- GET(url)
# Check if the request was successful
if (status_code(response) == 200) {
# Parse JSON content of the response
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
# Verify if study_files is a data frame
if (!is.data.frame(study_files)) {
stop("Expected study_files to be a data frame.")
}
# Filter for MAF files
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
# Check if MAF files were found
if (length(maf_files) > 0) {
return(maf_files)  # Return MAF file names
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", studyId)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(studyIds) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (studyId in vStudyIds) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[studyId]] <- get_maf_files(studyId)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[studyId]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
get_maf_filenames_for_studies(vStudyIds[1])
MAF_File_Names <- get_maf_filenames_for_studies("MTBLS4461")
# Retrieve MAF file names per study ID
get_maf_files <- function(study_id) {
# Construct URL for API call to download data
url <- paste0(BASE_URL, "/", study_id, "/files?include_raw_data=false")
# Send GET request to retrieve data
response <- GET(url)
# Check if the request was successful
if (status_code(response) == 200) {
# Parse JSON content of the response
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
# Verify if study_files is a data frame
if (!is.data.frame(study_files)) {
stop("Expected study_files to be a data frame.")
}
# Filter for MAF files
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
# Check if MAF files were found
if (length(maf_files) > 0) {
return(maf_files)  # Return MAF file names
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", study_id)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(study_ids) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (study_id in study_ids) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[study_id]] <- get_maf_files(study_id)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[study_id]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
MAF_File_Names <- get_maf_filenames_for_studies(vStudyIds[1])
MAF_File_Names <- get_maf_filenames_for_studies("MTBLS4461")
# Install metabolighteR from GitHub if not installed
if (!requireNamespace("metabolighteR", quietly = TRUE)) {
remotes::install_github('aberHRML/metabolighteR')
}
library(remotes)    # Load remotes package for installing packages from GitHub
library(metabolighteR)  # Load metabolighteR package for metabolite analysis
library(magrittr)
if(!"magrittr" %in% installed.packages()){install.packages("magrittr")}
if(!"remotes" %in% installed.packages()){install.packages("remotes")}
##Metabolights API location:
BASE_URL <- "https://www.ebi.ac.uk:443/metabolights/ws/studies"
##Access study IDs
getStudies <- function() {
studies <-
httr::GET(BASE_URL) %>% httr::content('parsed')
studyTibble <- dplyr::tibble(unlist(studies))
names(studyTibble) <- 'study'
return(studyTibble)
}
##Download all IDs of available studies.
allstudyIds <- getStudies()
##Convert response to a vector
vStudyIds <- allstudyIds[[1]]
# Retrieve MAF file names per study ID
get_maf_files <- function(study_id) {
# Construct URL for API call to download data
url <- paste0(BASE_URL, "/", study_id, "/files?include_raw_data=false")
# Send GET request to retrieve data
response <- GET(url)
# Check if the request was successful
if (status_code(response) == 200) {
# Parse JSON content of the response
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
# Verify if study_files is a data frame
if (!is.data.frame(study_files)) {
stop("Expected study_files to be a data frame.")
}
# Filter for MAF files
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
# Check if MAF files were found
if (length(maf_files) > 0) {
return(maf_files)  # Return MAF file names
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", study_id)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(study_ids) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (study_id in study_ids) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[study_id]] <- get_maf_files(study_id)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[study_id]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
# Call the function to retrieve MAF file names for the study IDs
MAF_File_Names <- get_maf_filenames_for_studies(vStudyIds)
get_maf_filenames_for_studies("MTBLS4461")
vStudyIds
vStudyIds[1]
vStudyIds[[1]]
MAF_File_Names <- get_maf_filenames_for_studies(vStudyIds[[1]])
allstudyIds[1]
##Download all IDs of available studies.
allstudyIds <- getStudies()
##Convert response to a vector
vStudyIds <- allstudyIds[1]
vStudyIds
View(allstudyIds)
vStudyIds <- as.vector(allstudyIds[1])
View(vStudyIds)
vStudyIds <- as.vector(allstudyIds[[1]])
vStudyIds[1]
# Retrieve MAF file names per study ID
get_maf_files <- function(study_id) {
# Construct URL for API call to download data
url <- paste0(BASE_URL, "/", study_id, "/files?include_raw_data=false")
# Send GET request to retrieve data
response <- GET(url)
# Check if the request was successful
if (status_code(response) == 200) {
# Parse JSON content of the response
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
# Verify if study_files is a data frame
if (!is.data.frame(study_files)) {
stop("Expected study_files to be a data frame.")
}
# Filter for MAF files
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
# Check if MAF files were found
if (length(maf_files) > 0) {
return(maf_files)  # Return MAF file names
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", study_id)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(study_ids) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (study_id in study_ids) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[study_id]] <- get_maf_files(study_id)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[study_id]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
MAF_File_Names <- get_maf_filenames_for_studies(vStudyIds[1])
MAF_File_Names <- get_maf_filenames_for_studies("MTBLS4461")
vStudyIds
MAF_File_Names <- get_maf_filenames_for_studies("MTBLS4461", "MTBLS2457")
test <- as.vector("MTBLS4461", "MTBLS2457")
test <- as.vector("MTBLS4461" "MTBLS2457")
test <- as.vector["MTBLS4461", "MTBLS2457"]
test <- as.vector["MTBLS4461" "MTBLS2457"]
test <- c("MTBLS4461" "MTBLS2457")
test <- c("MTBLS4461", "MTBLS2457")
MAF_File_Names <- get_maf_filenames_for_studies(test)
View(MAF_File_Names)
##Metabolights API location:
BASE_URL <- "https://www.ebi.ac.uk:443/metabolights/ws/studies"
##Access study IDs
getStudies <- function() {
studies <-
httr::GET(BASE_URL) %>% httr::content('parsed')
studyTibble <- dplyr::tibble(unlist(studies))
names(studyTibble) <- 'study'
return(studyTibble)
}
##Download all IDs of available studies.
allstudyIds <- getStudies()
##Convert response to a vector
vStudyIds <- as.vector(allstudyIds[[1]])
# Retrieve MAF file names per study ID
get_maf_files <- function(study_id) {
# Construct URL for API call to download data
url <- paste0(BASE_URL, "/", study_id, "/files?include_raw_data=false")
# Send GET request to retrieve data
response <- GET(url)
# Check if the request was successful
if (status_code(response) == 200) {
# Parse JSON content of the response
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
# Verify if study_files is a data frame
if (!is.data.frame(study_files)) {
stop("Expected study_files to be a data frame.")
}
# Filter for MAF files
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
# Check if MAF files were found
if (length(maf_files) > 0) {
return(maf_files)  # Return MAF file names
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", study_id)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(study_ids) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (study_id in vStudyIds) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[study_id]] <- get_maf_files(study_id)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[study_id]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
# Call the function to retrieve MAF file names for the study IDs
MAF_File_Names <- get_maf_filenames_for_studies(vStudyIds)
# Retrieve MAF file names per study ID
get_maf_files <- function(study_id) {
url <- paste0(BASE_URL, "/", study_id, "/files?include_raw_data=false")
response <- GET(url)
if (status_code(response) == 200) {
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
study_files <- files_info$study
# Make sure it's a list of lists
if (!is.list(study_files)) {
stop("Expected 'study' to be a list.")
}
# Extract filenames from the list of file entries
file_names <- sapply(study_files, function(file_entry) file_entry$file)
# Filter for MAF files
maf_files <- file_names[grepl("maf.tsv", file_names, ignore.case = TRUE)]
if (length(maf_files) > 0) {
return(maf_files)
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", study_id)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(study_ids) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (study_id in vStudyIds) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[study_id]] <- get_maf_files(study_id)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[study_id]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
# Call the function to retrieve MAF file names for the study IDs
MAF_File_Names <- get_maf_filenames_for_studies(vStudyIds)
study_ids <- as.vector(allstudyIds[[1]])
# Retrieve MAF file names per study ID
get_maf_files <- function(study_id) {
# Define base URL for MetaboLights API
base_url <- "https://www.ebi.ac.uk:443/metabolights/ws/studies"
# Construct URL for the specific study ID
url <- paste0(base_url, "/", study_id, "/files?include_raw_data=false")
# Send GET request to retrieve data
response <- GET(url)
# Check if the request was successful
if (status_code(response) == 200) {
# Parse JSON content of the response
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
# Verify if study_files is a data frame
if (!is.data.frame(study_files)) {
stop("Expected study_files to be a data frame.")
}
# Filter for MAF files
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
# Check if MAF files were found
if (length(maf_files) > 0) {
return(maf_files)  # Return MAF file names
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", study_id)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(study_ids) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (study_id in study_ids) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[study_id]] <- get_maf_files(study_id)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[study_id]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
# Call the function to retrieve MAF file names for the study IDs
MAF_File_Names <- get_maf_filenames_for_studies(study_ids)
url <- paste0(base_url, "/", study_ids[1], "/files?include_raw_data=false")
url <- paste0(BASE_URL, "/", study_ids[1], "/files?include_raw_data=false")
url
response <- GET(url)
##Executing requests for APIs:
if(!"httr" %in% installed.packages()){install.packages("httr")}
library(httr)
response <- GET(url)
response
# Retrieve MAF file names per study ID
get_maf_files <- function(study_id) {
# Construct URL for the specific study ID
url <- paste0(base_url, "/", study_id, "/files?include_raw_data=false")
# Send GET request to retrieve data
response <- GET(url)
# Check if the request was successful
if (status_code(response) == 200) {
# Parse JSON content of the response
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
# Verify if study_files is a data frame
if (!is.data.frame(study_files)) {
stop("Expected study_files to be a data frame.")
}
# Filter for MAF files
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
# Check if MAF files were found
if (length(maf_files) > 0) {
return(maf_files)  # Return MAF file names
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", study_id)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(study_ids) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (study_id in study_ids) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[study_id]] <- get_maf_files(study_id)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[study_id]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
# Call the function to retrieve MAF file names for the study IDs
MAF_File_Names <- get_maf_filenames_for_studies(study_ids)
# Retrieve MAF file names per study ID
get_maf_files <- function(study_id) {
# Construct URL for the specific study ID
url <- paste0(BASE_URL, "/", study_id, "/files?include_raw_data=false")
# Send GET request to retrieve data
response <- GET(url)
# Check if the request was successful
if (status_code(response) == 200) {
# Parse JSON content of the response
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
# Verify if study_files is a data frame
if (!is.data.frame(study_files)) {
stop("Expected study_files to be a data frame.")
}
# Filter for MAF files
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
# Check if MAF files were found
if (length(maf_files) > 0) {
return(maf_files)  # Return MAF file names
} else {
stop("MAF file not found in the study files list")
}
} else {
stop("Failed to retrieve files list for study: ", study_id)
}
}
# Function to process multiple study IDs and get their MAF file names
get_maf_filenames_for_studies <- function(study_ids) {
# Initialize list to store MAF file names or error messages
maf_file_names <- list()
# Iterate over each study ID
for (study_id in study_ids) {
tryCatch({
# Attempt to fetch MAF file names for current study ID
maf_file_names[[study_id]] <- get_maf_files(study_id)
}, error = function(e) {
# Store error message if an error occurs
maf_file_names[[study_id]] <- paste("Error:", e$message)
})
}
return(maf_file_names)  # Return list of MAF file names or error messages
}
# Call the function to retrieve MAF file names for the study IDs
MAF_File_Names <- get_maf_filenames_for_studies(study_ids)
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
??fromJSON
if(!"jsonlite" %in% installed.packages()){install.packages("jsonlite")}
library(jsonlite)       # Load jsonlite package for handling JSON data from API calls
files_info <- fromJSON(content(response, as = "text", encoding = "UTF-8"))
# Extract study files information
study_files <- files_info$study
is.data.frame(study_files)
maf_files <- study_files$file[grepl("maf.tsv", study_files$file, ignore.case = TRUE)]
maf_files
length(maf_files) > 0
##Convert response to a vector
vStudyIds <- as.vector(allstudyIds[[1]])
